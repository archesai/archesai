apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  - ../../base
  - stripe-webhook-proxy.yaml

components:
  - ../../components/database
  - ../../components/redis
  - ../../components/storage
  - ../../components/platform
  - ../../components/scraper
  - ../../components/unstructured
  - ../../components/tls

secretGenerator:
  - name: archesai-config-volume
    behavior: merge
    files:
      - z-development-config.yaml
  - name: archesai-config-tls
    type: kubernetes.io/tls
    files:
      - tls.crt=./certs/fullchain.pem
      - tls.key=./certs/privkey.pem

patches:
  - target:
      kind: Job
      name: migrations
    path: migrations-job.patch.yaml
