apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

secretGenerator:
  - name: arches-redis-ca-cert
    files:
      - "./redis-ca.pem"

resources:
  - "../../../base"
  - "./arches-frontend-config.yaml"
  - "./arches-api-managedcertificate.yaml"
  - "./arches-api-ingress.yaml"

patches:
  - path: "./arches-api-deployment.patch.yaml"
    target:
      kind: Deployment
      name: arches-api
  - path: "./arches-upgrade-job.patch.yaml"
    target:
      kind: Job
      name: arches-upgrade
  - path: "./arches-api-service-account.patch.yaml"
    target:
      kind: ServiceAccount
      name: arches-api-service-account
