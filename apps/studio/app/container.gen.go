// Code generated by archesai. DO NOT EDIT.

package app

import (
	"github.com/archesai/archesai/apps/studio/database/postgres/repositories"
	sqliterepos "github.com/archesai/archesai/apps/studio/database/sqlite/repositories"
	authapp "github.com/archesai/archesai/pkg/auth/app"
	configapp "github.com/archesai/archesai/pkg/config/app"
	"github.com/archesai/archesai/pkg/database"
	"github.com/archesai/archesai/pkg/events"
	executorapp "github.com/archesai/archesai/pkg/executor/app"
	pipelinesapp "github.com/archesai/archesai/pkg/pipelines/app"
	serverapp "github.com/archesai/archesai/pkg/server/app"
	storageapp "github.com/archesai/archesai/pkg/storage/app"
)

// NewPorts creates Ports by composing internal package ports.
func NewPorts(db *database.Database) *Ports {
	publisher := events.NewNoOpPublisher()

	if db.IsSQLite() {
		sqlDB := db.SQLDB()
		return &Ports{
			Auth: &authapp.Ports{
				APIKeyRepo:       sqliterepos.NewSQLiteAPIKeyRepository(sqlDB),
				AccountRepo:      sqliterepos.NewSQLiteAccountRepository(sqlDB),
				InvitationRepo:   sqliterepos.NewSQLiteInvitationRepository(sqlDB),
				MemberRepo:       sqliterepos.NewSQLiteMemberRepository(sqlDB),
				OrganizationRepo: sqliterepos.NewSQLiteOrganizationRepository(sqlDB),
				SessionRepo:      sqliterepos.NewSQLiteSessionRepository(sqlDB),
				UserRepo:         sqliterepos.NewSQLiteUserRepository(sqlDB),
				Publisher:        publisher,
			},
			Config: &configapp.Ports{},
			Executor: &executorapp.Ports{
				ExecutorRepo: sqliterepos.NewSQLiteExecutorRepository(sqlDB),
				Publisher:    publisher,
			},
			Pipelines: &pipelinesapp.Ports{
				PipelineRepo: sqliterepos.NewSQLitePipelineRepository(sqlDB),
				RunRepo:      sqliterepos.NewSQLiteRunRepository(sqlDB),
				ToolRepo:     sqliterepos.NewSQLiteToolRepository(sqlDB),
				Publisher:    publisher,
			},
			Server: &serverapp.Ports{},
			Storage: &storageapp.Ports{
				ArtifactRepo: sqliterepos.NewSQLiteArtifactRepository(sqlDB),
				LabelRepo:    sqliterepos.NewSQLiteLabelRepository(sqlDB),
				Publisher:    publisher,
			},
		}
	}

	pool := db.PgxPool()
	return &Ports{
		Auth: &authapp.Ports{
			APIKeyRepo:       repositories.NewPostgresAPIKeyRepository(pool),
			AccountRepo:      repositories.NewPostgresAccountRepository(pool),
			InvitationRepo:   repositories.NewPostgresInvitationRepository(pool),
			MemberRepo:       repositories.NewPostgresMemberRepository(pool),
			OrganizationRepo: repositories.NewPostgresOrganizationRepository(pool),
			SessionRepo:      repositories.NewPostgresSessionRepository(pool),
			UserRepo:         repositories.NewPostgresUserRepository(pool),
			Publisher:        publisher,
		},
		Config: &configapp.Ports{},
		Executor: &executorapp.Ports{
			ExecutorRepo: repositories.NewPostgresExecutorRepository(pool),
			Publisher:    publisher,
		},
		Pipelines: &pipelinesapp.Ports{
			PipelineRepo: repositories.NewPostgresPipelineRepository(pool),
			RunRepo:      repositories.NewPostgresRunRepository(pool),
			ToolRepo:     repositories.NewPostgresToolRepository(pool),
			Publisher:    publisher,
		},
		Server: &serverapp.Ports{},
		Storage: &storageapp.Ports{
			ArtifactRepo: repositories.NewPostgresArtifactRepository(pool),
			LabelRepo:    repositories.NewPostgresLabelRepository(pool),
			Publisher:    publisher,
		},
	}
}
