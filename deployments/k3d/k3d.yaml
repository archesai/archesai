# yaml-language-server: $schema=https://raw.githubusercontent.com/rancher/k3d/main/pkg/config/config.versions.schema.json
apiVersion: k3d.io/v1alpha5
kind: Simple
metadata:
  name: tower
servers: 1
agents: 2
options:
  k3s:
    extraArgs:
      - arg: "--disable=traefik"
        nodeFilters:
          - server:0
ports:
  - port: 80:80
    nodeFilters:
      - loadbalancer
  - port: 443:443
    nodeFilters:
      - loadbalancer
  - port: 5432:30054
    nodeFilters:
      - server:0
  - port: 6379:30055
    nodeFilters:
      - server:0
  - port: 3100:30056
    nodeFilters:
      - server:0
registries:
  create:
    name: registry.localhost
    host: "0.0.0.0"
    hostPort: "5000"
  # config: |
  #   mirrors:
  #     'localhost:5000':
  #       endpoint:
  #         - http://registry.localhost:5000
hostAliases:
  - ip: "172.18.0.1" # The IP of your host the way it is seen from inside the k3d containers
    hostnames:
      - "storage.localhost"
      - "storage.archesai.dev"
