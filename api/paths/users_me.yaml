get:
  operationId: getCurrentUser
  summary: Get current user
  tags:
    - Users
  description: Get the currently authenticated user's profile
  security:
    - bearerAuth: []
    - sessionCookie: []
  responses:
    '200':
      description: Current user retrieved successfully
      content:
        application/json:
          schema:
            type: object
            additionalProperties: false
            required:
              - data
            properties:
              data:
                $ref: ../components/schemas/User.yaml
    '401':
      $ref: ../components/responses/Unauthorized.yaml

patch:
  operationId: updateCurrentUser
  summary: Update current user
  tags:
    - Users
  description: Update the currently authenticated user's profile
  security:
    - bearerAuth: []
    - sessionCookie: []
  requestBody:
    required: true
    content:
      application/json:
        schema:
          type: object
          properties:
            name:
              description: The user's display name
              type: string
              minLength: 1
              maxLength: 255
              example: John Doe
            image:
              description: The user's avatar image URL
              type: string
              minLength: 5
              maxLength: 2048
              format: uri
              example: 'https://example.com/avatar.jpg'
  responses:
    '200':
      description: User updated successfully
      content:
        application/json:
          schema:
            type: object
            additionalProperties: false
            required:
              - data
            properties:
              data:
                $ref: ../components/schemas/User.yaml
    '400':
      $ref: ../components/responses/BadRequest.yaml
    '401':
      $ref: ../components/responses/Unauthorized.yaml

delete:
  operationId: deleteCurrentUser
  summary: Delete current user
  tags:
    - Users
  description: Delete the currently authenticated user's account (cascades to all sessions and accounts)
  security:
    - bearerAuth: []
    - sessionCookie: []
  requestBody:
    required: true
    content:
      application/json:
        schema:
          type: object
          properties:
            confirmation:
              description: Confirmation string to prevent accidental deletion
              type: string
              enum:
                - DELETE_MY_ACCOUNT
              example: DELETE_MY_ACCOUNT
          required:
            - confirmation
  responses:
    '200':
      description: User deleted successfully
      content:
        application/json:
          schema:
            type: object
            additionalProperties: false
            required:
              - message
            properties:
              message:
                type: string
                example: User account successfully deleted
    '400':
      $ref: ../components/responses/BadRequest.yaml
    '401':
      $ref: ../components/responses/Unauthorized.yaml
