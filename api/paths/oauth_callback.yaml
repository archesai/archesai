get:
  operationId: OauthCallback
  x-codegen-custom-handler: true
  summary: Handle OAuth callback
  tags:
    - Auth
  description: Handle the callback from OAuth provider and complete authentication
  parameters:
    - schema:
        type: string
        enum:
          - google
          - github
          - microsoft
        example: google
      in: path
      name: provider
      required: true
      description: The OAuth provider handling the callback
    - schema:
        type: string
        maxLength: 1024
        pattern: ^[\w\-]+$
        example: authorization_code_123
      in: query
      name: code
      required: false
      description: Authorization code from OAuth provider
    - schema:
        type: string
        maxLength: 255
        pattern: ^[\w\-]+$
        example: random_state_123
      in: query
      name: state
      required: false
      description: State parameter for CSRF protection
    - schema:
        type: string
        maxLength: 100
        pattern: ^[\w\-_]+$
        example: access_denied
      in: query
      name: error
      required: false
      description: Error code if authorization failed
    - schema:
        type: string
        maxLength: 500
        pattern: ^[\w\s\-.,!?()@#+/]*$
        example: The user denied the request
      in: query
      name: error_description
      required: false
      description: Human-readable error description
  responses:
    '200':
      description: OAuth authentication successful when Accept header is application/json
      content:
        application/json:
          schema:
            $ref: ../components/schemas/Session.yaml
          example:
            id: 550e8400-e29b-41d4-a716-446655440000
            userID: 550e8400-e29b-41d4-a716-446655440001
            token: sess_1234567890abcdef
            expiresAt: '2024-02-15T09:30:00Z'
            createdAt: '2024-01-15T09:30:00Z'
            updatedAt: '2024-01-15T09:30:00Z'
      headers:
        X-RateLimit-Limit:
          description: The maximum number of requests allowed per time window
          schema:
            type: integer
            example: 1000
            format: int32
            minimum: 1
            maximum: 1000000
        X-RateLimit-Remaining:
          description: The number of requests remaining in the current time window
          schema:
            type: integer
            example: 999
            format: int32
            minimum: 0
            maximum: 1000000
        X-RateLimit-Reset:
          description: The time at which the current rate limit window resets (Unix timestamp)
          schema:
            type: integer
            example: 1640995200
            format: int64
            minimum: 0
            maximum: 9223372036854775807
    '302':
      description: Redirect to frontend with authentication result
      headers:
        Set-Cookie:
          description: Session cookies for authentication
          schema:
            type: string
            minLength: 1
            maxLength: 4096
            pattern: ^[\w\-=;,. ]+$
        Location:
          description: Redirect URL to frontend
          schema:
            type: string
            format: uri
            maxLength: 2048
            example: http://localhost:3000/auth/success
        X-RateLimit-Limit:
          description: The maximum number of requests allowed per time window
          schema:
            type: integer
            example: 1000
            format: int32
            minimum: 1
            maximum: 1000000
        X-RateLimit-Remaining:
          description: The number of requests remaining in the current time window
          schema:
            type: integer
            example: 999
            format: int32
            minimum: 0
            maximum: 1000000
        X-RateLimit-Reset:
          description: The time at which the current rate limit window resets (Unix timestamp)
          schema:
            type: integer
            example: 1640995200
            format: int64
            minimum: 0
            maximum: 9223372036854775807
    '400':
      $ref: ../components/responses/BadRequest.yaml
    '401':
      $ref: ../components/responses/Unauthorized.yaml
    '422':
      $ref: ../components/responses/UnprocessableEntity.yaml
    '404':
      description: OAuth provider not found
      headers:
        X-RateLimit-Limit:
          description: The maximum number of requests allowed per time window
          schema:
            type: integer
            example: 1000
            format: int32
            minimum: 1
            maximum: 1000000
        X-RateLimit-Remaining:
          description: The number of requests remaining in the current time window
          schema:
            type: integer
            example: 999
            format: int32
            minimum: 0
            maximum: 1000000
        X-RateLimit-Reset:
          description: The time at which the current rate limit window resets (Unix timestamp)
          schema:
            type: integer
            example: 1640995200
            format: int64
            minimum: 0
            maximum: 9223372036854775807
      content:
        application/problem+json:
          schema:
            $ref: ../components/schemas/Problem.yaml
    '429':
      $ref: ../components/responses/TooManyRequests.yaml
    '500':
      $ref: ../components/responses/InternalServerError.yaml
