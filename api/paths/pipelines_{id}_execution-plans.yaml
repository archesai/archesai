get:
  operationId: getPipelineExecutionPlan
  summary: Get execution plan for a pipeline
  tags:
    - Workflows
  description: Get the DAG execution plan showing which steps can run in parallel
  parameters:
    - name: id
      in: path
      required: true
      description: Pipeline ID
      schema:
        type: string
        format: uuid
  security:
    - bearerAuth: []
  responses:
    "200":
      description: Execution plan retrieved successfully
      content:
        application/json:
          schema:
            type: object
            properties:
              data:
                type: object
                properties:
                  pipelineId:
                    type: string
                    format: uuid
                    minLength: 1
                    example: "123e4567-e89b-12d3-a456-426614174000"
                  levels:
                    type: array
                    items:
                      type: object
                      properties:
                        level:
                          type: integer
                          description: Execution level (0-based)
                          example: 0
                        steps:
                          type: array
                          items:
                            type: string
                            format: uuid
                          description: Step IDs that can run in parallel at this level
                      required:
                        - level
                        - steps
                  totalSteps:
                    type: integer
                    description: Total number of steps in the pipeline
                    example: 5
                  isValid:
                    type: boolean
                    description: Whether the pipeline DAG is valid (no cycles)
                    example: true
                  estimatedDuration:
                    type: integer
                    description: Estimated execution time in seconds
                    example: 3600
                required:
                  - pipelineId
                  - levels
                  - totalSteps
                  - isValid
            required:
              - data
            additionalProperties: false
    "400":
      $ref: ../components/responses/BadRequest.yaml
    "404":
      $ref: ../components/responses/NotFound.yaml
    "401":
      $ref: ../components/responses/Unauthorized.yaml

post:
  operationId: validatePipelineExecutionPlan
  summary: Validate a pipeline configuration
  tags:
    - Workflows
  description: Validate that a pipeline can be executed without issues
  parameters:
    - name: id
      in: path
      required: true
      description: Pipeline ID
      schema:
        type: string
        format: uuid
  security:
    - bearerAuth: []
  responses:
    "200":
      description: Pipeline is valid
      content:
        application/json:
          schema:
            type: object
            properties:
              data:
                type: object
                properties:
                  valid:
                    type: boolean
                    example: true
                  issues:
                    type: array
                    items:
                      type: string
                    description: List of any warnings or non-critical issues
                required:
                  - valid
            required:
              - data
            additionalProperties: false
    "400":
      $ref: ../components/responses/BadRequest.yaml
    "404":
      $ref: ../components/responses/NotFound.yaml
    "401":
      $ref: ../components/responses/Unauthorized.yaml