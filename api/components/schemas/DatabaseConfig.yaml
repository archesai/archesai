# yaml-language-server: $schema=https://json-schema.org/draft/2020-12/schema
description: Database configuration for PostgreSQL
type: object
properties:
  enabled:
    description: Enable database
    type: boolean
    default: true
    example: true
  URL:
    description: Database connection URL/string
    type: string
    default: postgresql://admin:password@127.0.0.1:5432/archesai
    minLength: 1
    example: example-string
  type:
    description: Database type (postgresql or sqlite)
    type: string
    enum: [postgresql, sqlite]
    default: postgresql
    example: postgresql
  maxConns:
    description: Maximum number of connections in pool (PostgreSQL)
    type: integer
    minimum: 1
    default: 25
    example: 25
  minConns:
    description: Minimum number of connections in pool (PostgreSQL)
    type: integer
    minimum: 0
    default: 5
    example: 5
  connMaxLifetime:
    description: Maximum connection lifetime (e.g., "30m")
    type: string
    pattern: '^(\d+[smh])+$'
    example: 30m
  connMaxIdleTime:
    description: Maximum connection idle time (e.g., "5m")
    type: string
    pattern: '^(\d+[smh])+$'
    example: 5m
  healthCheckPeriod:
    description: Health check period for connections (PostgreSQL)
    type: string
    pattern: '^(\d+[smh])+$'
    example: 30s
  runMigrations:
    description: Automatically run database migrations on startup
    type: boolean
    default: false
    example: true
  managed:
    description: Use managed database deployment
    type: boolean
    default: false
    example: true
  auth:
    $ref: ./DatabaseAuth.yaml
  image:
    $ref: ./ImageConfig.yaml
  persistence:
    $ref: ./PersistenceConfig.yaml
  resources:
    $ref: ./ResourceConfig.yaml
required:
  - enabled
  - URL
additionalProperties: false
