x-codegen-schema-type: entity
x-codegen:
  repository:
    excludeFromUpdate:
      - IPAddress
      - UserID
      - UserAgent
      - Token
    relations:
      - field: userID
        references: user
        onDelete: CASCADE
        onUpdate: NO_ACTION
    indices:
      - userID
      - token
description: Schema for Session entity
title: Session
allOf:
  - $ref: ./Base.yaml
  - type: object
    properties:
      organizationID:
        description:
          The organization ID for this session (nullable for users without
          org)
        type: [string, 'null']
        format: uuid
        example: 550e8400-e29b-41d4-a716-446655440000
        minLength: 36
        maxLength: 36
      authMethod:
        description:
          The authentication method used (magic_link, oauth_google, oauth_github,
          etc.)
        type: [string, 'null']
        minLength: 1
        maxLength: 100
        example: magic_link
        pattern: ^[a-z_]+$
      authProvider:
        description: The authentication provider (google, github, microsoft, local)
        type: [string, 'null']
        enum:
          - local
          - google
          - github
          - microsoft
          - apple
        example: local
      expiresAt:
        description: The expiration date of the session
        type: string
        minLength: 1
        format: date-time
        example: '2023-10-05T14:48:00Z'
        maxLength: 255
      ipAddress:
        description: The IP address of the session
        type: [string, 'null']
        format: ipv4
        example: 192.168.1.1
        minLength: 7
        maxLength: 45
      token:
        description: The session token
        type: string
        minLength: 1
        example: eyJhbGciOiJIUzI1NiIs...
        maxLength: 512
        pattern: ^[A-Za-z0-9_\-\.]+$
      userAgent:
        description: The user agent of the session
        type: [string, 'null']
        example: Mozilla/5.0 (Windows NT 10.0; Win64; x64)
        minLength: 1
        maxLength: 255
        pattern: ^[\w\s\-.,!?()@#+/\(\):;]+$
      userID:
        description: The user who owns this session
        type: string
        format: uuid
        example: 550e8400-e29b-41d4-a716-446655440000
        minLength: 36
        maxLength: 36
    required:
      - expiresAt
      - token
      - userID
      - organizationID
      - authMethod
      - authProvider
      - ipAddress
      - userAgent
unevaluatedProperties: false
example:
  id: 550e8400-e29b-41d4-a716-446655440000
  createdAt: '2023-10-05T14:48:00Z'
  updatedAt: '2023-10-05T14:48:00Z'
  organizationID: 550e8400-e29b-41d4-a716-446655440000
  authMethod: magic_link
  authProvider: local
  expiresAt: '2023-10-05T14:48:00Z'
  ipAddress:
