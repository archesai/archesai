# yaml-language-server: $schema=https://json-schema.org/draft/2020-12/schema
description: Schema for Session entity
x-codegen:
  repository:
    operations: [create, read, update, delete, list]
    indices: [userID, token]
    update_exclude: [ipAddress, token, userAgent] # These fields are readonly after creation
    additional_methods:
      - name: GetByToken
        params: [token]
        returns: single
      - name: DeleteByToken
        params: [token]
        returns: void
      - name: DeleteByUser
        params: [userID]
        returns: void
      - name: DeleteExpired
        params: []
        returns: void
allOf:
  - $ref: ./Base.yaml
  - type: object
    properties:
      organizationID:
        description: The organization ID for this session (nullable for users without org)
        allOf:
          - $ref: ./UUID.yaml
      authMethod:
        description: The authentication method used (magic_link, oauth_google, oauth_github, etc.)
        type: string
        example: magic_link
      authProvider:
        description: The authentication provider (google, github, microsoft, local)
        type: string
        example: local
      expiresAt:
        description: The expiration date of the session
        type: string
        minLength: 1
        format: date-time
        example: '2023-10-05T14:48:00Z'
      ipAddress:
        description: The IP address of the session
        type: string
        example: example-string
        minLength: 1
      token:
        description: The session token
        type: string
        minLength: 1
        example: example-string
      userAgent:
        description: The user agent of the session
        type: string
        example: example-string
        minLength: 1
      userID:
        allOf:
          - $ref: ./UUID.yaml
    required:
      - expiresAt
      - ipAddress
      - token
      - userAgent
      - userID
    additionalProperties: false
