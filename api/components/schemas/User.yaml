# yaml-language-server: $schema=https://json-schema.org/draft-07/schema
description: Schema for User entity
x-codegen:
  domain: users
  repository:
    operations: [read, update, delete, list] # No create endpoint in API
    indices: [email]
    additional_methods:
      - name: GetByEmail
        params: [email]
        returns: single
  cache:
    enabled: true
    ttl: 300 # 5 minutes
    key_pattern: 'user:{id}'
    invalidate_on: [update, delete]
  events:
    - created
    - updated
    - deleted
    - email_verified
  service:
    business_methods:
      - verify_email
allOf:
  - $ref: ./Base.yaml
  - type: object
    properties:
      email:
        description: The user's email address
        type: string
        format: email
        minLength: 5
        maxLength: 255
        example: user@example.com
      emailVerified:
        description: Whether the user's email has been verified
        type: boolean
        default: false
        example: true
      image:
        description: The user's avatar image URL
        type: string
        minLength: 5
        maxLength: 2048
        format: uri
        example: 'https://example.com/avatar.jpg'
      name:
        description: The user's display name
        type: string
        minLength: 1
        maxLength: 255
        example: John Doe
    required:
      - email
      - emailVerified
      - name
unevaluatedProperties: false
