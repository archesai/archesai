# yaml-language-server: $schema=https://json-schema.org/draft/2020-12/schema
description: Schema for PipelineStep entity
allOf:
  - $ref: ./Base.yaml
  - type: object
    properties:
      pipelineId:
        description: The ID of the pipeline this step belongs to
        type: string
        format: uuid
        minLength: 1
        example: "123e4567-e89b-12d3-a456-426614174000"
      toolId:
        description: The ID of the tool to execute
        type: string
        format: uuid
        minLength: 1
        example: "987fcdeb-51a2-43d1-9876-543210fedcba"
      name:
        description: Name of the step
        type: string
        minLength: 1
        maxLength: 255
        example: "Data Validation"
      description:
        description: Description of what this step does
        type: string
        maxLength: 1000
        example: "Validates incoming data against schema"
      config:
        description: Configuration parameters for the tool
        type: object
        additionalProperties: true
        example:
          schema: "v1.0"
          strict: true
          maxErrors: 10
      position:
        description: Position in the pipeline for ordering
        type: integer
        minimum: 0
        example: 1
      retries:
        description: Number of retries on failure
        type: integer
        minimum: 0
        maximum: 10
        default: 0
        example: 3
      timeout:
        description: Timeout in seconds
        type: integer
        minimum: 1
        maximum: 86400
        default: 3600
        example: 1800
      dependencies:
        description: IDs of steps this step depends on
        type: array
        items:
          type: string
          format: uuid
        example: ["123e4567-e89b-12d3-a456-426614174000"]
      status:
        description: Current status of the step
        type: string
        enum:
          - pending
          - ready
          - running
          - completed
          - failed
          - skipped
        default: pending
        example: pending
    required:
      - pipelineId
      - toolId
      - name
    additionalProperties: false