# yaml-language-server: $schema=./xcodegen/JSONSchemaDraft7Extended.yaml
description: Schema for Account entity (authentication provider account)
title: Account
x-codegen:
  schemaType: entity
  service:
    generate: true
    transaction_support: false
    error_handling: error_return
  handler:
    generate: true
  repository:
    operations: [create, read, update, delete, list]
    indices: [userID, accountID]
    additional_methods:
      - name: GetByProviderID
        params: [provider, providerAccountID]
        returns: single
      - name: ListByUserID
        params: [userID]
        returns: multiple
allOf:
  - $ref: ./Base.yaml
  - type: object
    properties:
      accountID:
        description: The unique identifier for the account from the provider
        type: string
        example: google_123456789
        minLength: 1
      userID:
        description: The user ID this account belongs to
        type: string
        format: uuid
        example: 550e8400-e29b-41d4-a716-446655440000
        minLength: 36
      providerID:
        description: The authentication provider identifier
        type: string
        enum:
          - local
          - google
          - github
          - microsoft
          - apple
        example: google
      accessToken:
        description: The OAuth access token
        type: string
        example: 'ya29.a0AfH6SMBa...'
        x-sensitive: true
      accessTokenExpiresAt:
        description: The access token expiration timestamp
        type: string
        format: date-time
        example: '2024-12-31T23:59:59Z'
      refreshToken:
        description: The OAuth refresh token
        type: string
        example: '1//0fM8N5...'
        x-sensitive: true
      refreshTokenExpiresAt:
        description: The refresh token expiration timestamp
        type: string
        format: date-time
        example: '2025-12-31T23:59:59Z'
      idToken:
        description: The OpenID Connect ID token
        type: string
        example: 'eyJhbGciOiJSUzI1NiIs...'
        x-sensitive: true
      scope:
        description: The OAuth scope granted
        type: string
        example: 'openid profile email'
    required:
      - accountID
      - userID
      - providerID
unevaluatedProperties: false
