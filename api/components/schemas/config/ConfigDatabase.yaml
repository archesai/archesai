title: DatabaseConfig
description: Database configuration for PostgreSQL
type: object
properties:
  enabled:
    description: Enable database
    type: boolean
    default: true
    example: true
  url:
    description: Database connection url/string
    type: string
    format: uri
    default: postgresql://admin:password@127.0.0.1:5432/archesai
    minLength: 1
    example: postgresql://admin:password@127.0.0.1:5432/archesai
    maxLength: 2048
  type:
    description: Database type (postgresql or sqlite)
    type: string
    enum:
      - postgresql
      - sqlite
    default: postgresql
    example: postgresql
  maxConns:
    description: Maximum number of connections in pool (PostgreSQL)
    type: integer
    minimum: 1
    maximum: 2147483647
    format: int32
    default: 25
    example: 25
  minConns:
    description: Minimum number of connections in pool (PostgreSQL)
    type: integer
    format: int32
    minimum: 0
    maximum: 2147483647
    default: 5
    example: 5
  connMaxLifetime:
    description: Maximum connection lifetime (e.g., "30m")
    type: string
    pattern: ^(\d+[smh])+$
    minLength: 2
    maxLength: 20
    example: 30m
  connMaxIdleTime:
    description: Maximum connection idle time (e.g., "5m")
    type: string
    pattern: ^(\d+[smh])+$
    minLength: 2
    maxLength: 20
    example: 5m
  healthCheckPeriod:
    description: Health check period for connections (PostgreSQL)
    type: string
    pattern: ^(\d+[smh])+$
    minLength: 2
    maxLength: 20
    example: 30s
  runMigrations:
    description: Automatically run database migrations on startup
    type: boolean
    default: false
    example: true
  managed:
    description: Use managed database deployment
    type: boolean
    default: false
    example: true
  image:
    $ref: ./ConfigImage.yaml
  persistence:
    $ref: ./ConfigPersistence.yaml
  resources:
    $ref: ./ConfigResource.yaml
required:
  - enabled
  - url
  - type
  - maxConns
  - minConns
  - runMigrations
  - managed
additionalProperties: false
x-codegen:
  schemaType: valueobject
