# yaml-language-server: $schema=https://json-schema.org/draft/2020-12/schema
description: Schema for codegen.yaml configuration file
type: object
properties:
  openapi:
    type: string
    description: Path to the OpenAPI specification file
    example: 'api/openapi.bundled.yaml'

  output:
    type: string
    description: Output directory for generated files
    default: 'internal'
    example: 'internal'

  domains:
    type: object
    description: Domains to generate
    additionalProperties:
      type: object
      properties:
        tags:
          type: array
          items:
            type: string
        schemas:
          type: array
          items:
            type: string

  settings:
    type: object
    description: Global generation settings
    properties:
      overwrite:
        type: boolean
        description: Whether to overwrite existing files
        default: false
      generate_tests:
        type: boolean
        description: Whether to generate test files
        default: false
      header:
        type: string
        description: File header comment
    additionalProperties: false

  generators:
    type: object
    description: Generator configuration with output paths
    properties:
      repository:
        type: object
        description: Repository generation configuration
        properties:
          interface:
            type: string
            description: Path for repository interfaces (ports)
            example: 'ports.gen.go'
          postgres:
            type: string
            description: Path for PostgreSQL repository implementation
            example: 'postgres_repository.gen.go'
          sqlite:
            type: string
            description: Path for SQLite repository implementation
            example: 'sqlite_repository.gen.go'
        additionalProperties: false
      cache:
        type: object
        description: Cache generation paths
        properties:
          interface:
            type: string
            description: Path for cache interface
            example: 'cache.gen.go'
          memory:
            type: string
            description: Path for in-memory cache implementation
            example: 'cache_memory.gen.go'
          redis:
            type: string
            description: Path for Redis cache implementation
            example: 'cache_redis.gen.go'
        additionalProperties: false
      events:
        type: object
        description: Event system generation paths
        properties:
          interface:
            type: string
            description: Path for event definitions and interface
            example: 'events.gen.go'
          redis:
            type: string
            description: Path for Redis event publisher
            example: 'events_redis.gen.go'
          nats:
            type: string
            description: Path for NATS event publisher
            example: 'events_nats.gen.go'
        additionalProperties: false
      sql:
        type: object
        description: SQL generation configuration
        properties:
          schema_dir:
            type: string
            description: Directory for SQL schema files
            example: 'internal/database/schema'
          query_dir:
            type: string
            description: Directory for SQL query files
            example: 'internal/database/queries'
          dialect:
            type: string
            description: SQL dialect to use
            enum: ['postgresql', 'sqlite', 'mysql']
            default: 'postgresql'
        additionalProperties: false
      handlers:
        type: string
        description: Path for HTTP handler generation
        example: 'handlers.gen.go'
      adapters:
        type: string
        description: Path for type adapters/mappers
        example: 'adapters.gen.go'
      tests:
        oneOf:
          - type: boolean
            description: Enable/disable test generation with default paths
          - type: object
            description: Test generation paths
            properties:
              unit:
                type: string
                description: Path for unit tests
                example: 'service_test.gen.go'
              integration:
                type: string
                description: Path for integration tests
                example: 'integration_test.gen.go'
              mocks:
                type: string
                description: Path for mock implementations
                example: 'mocks_test.gen.go'
            additionalProperties: false
      defaults:
        type: string
        description: Path for configuration defaults (relative to project root)
        example: './internal/config/defaults.gen.go'
    additionalProperties: false

required:
  - openapi

additionalProperties: false
