# yaml-language-server: $schema=./JSONSchema2020Extended.yaml
title: XCodegenExtension
description: Configuration for code generation from OpenAPI schemas
type: object
required: [schemaType]
properties:
  schemaType:
    description: Type of domain object (entity, valueobject)
    type: string
    enum: [entity, valueobject]

  repository:
    description: Repository generation configuration
    type: object
    properties:
      operations:
        description: Standard CRUD operations to generate
        type: array
        items:
          type: string
          enum: [create, read, update, delete, list]
        default: [create, read, update, delete, list]
      indices:
        description: Database indices to create
        type: array
        items:
          type: string
      excludeFromCreate:
        description: Fields to exclude from Create operations (e.g., auto-generated or DB-set fields)
        type: array
        items:
          type: string
      excludeFromUpdate:
        description: Fields to exclude from Update operations (e.g., immutable fields)
        type: array
        items:
          type: string
      additionalMethods:
        description: Additional repository methods to generate
        type: array
        items:
          type: object
          properties:
            name:
              description: Method name
              type: string
            params:
              description: Method parameters
              type: array
              items:
                type: object
                properties:
                  name:
                    description: Parameter name
                    type: string
                  type:
                    description: Parameter type (e.g., string, int)
                    type: string
                  format:
                    description: Parameter format (e.g., uuid, email) - optional
                    type: string
                required: [name, type]
            returns:
              description: Return type (single or multiple)
              type: string
              enum: [single, multiple]
          required: [name, returns]
          additionalProperties: false
      tableName:
        description: Override default table name
        type: string
      relations:
        description: Foreign key relationships to other entities
        type: array
        items:
          type: object
          properties:
            field:
              description: The field name in this entity that references another entity
              type: string
            references:
              description: The table name being referenced (snake_case)
              type: string
            referencesField:
              description: The field in the referenced table (defaults to 'id')
              type: string
            onUpdate:
              description: Foreign key ON UPDATE action
              type: string
              enum: [CASCADE, SET_NULL, SET_DEFAULT, RESTRICT, NO_ACTION]
              default: NO_ACTION
            onDelete:
              description: Foreign key ON DELETE action
              type: string
              enum: [CASCADE, SET_NULL, SET_DEFAULT, RESTRICT, NO_ACTION]
              default: CASCADE
          required: [field, references]
          additionalProperties: false
    additionalProperties: false
# This schema defines the x-codegen extension structure
# It needs x-codegen to generate the Go types for parsing
x-codegen:
  schemaType: valueobject
