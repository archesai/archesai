# yaml-language-server: $schema=./JSONSchemaDraft7Extended.yaml
$schema: https://json-schema.org/draft-07/schema
title: XCodegenExtension
description: Configuration for code generation from OpenAPI schemas
type: object
required: [schemaType]
properties:
  schemaType:
    description: Type of domain object (entity, valueobject)
    type: string
    enum: [entity, valueobject]

  repository:
    description: Repository generation configuration
    type: object
    properties:
      operations:
        description: Standard CRUD operations to generate
        type: array
        items:
          type: string
          enum: [create, read, update, delete, list]
        default: [create, read, update, delete, list]
      indices:
        description: Database indices to create
        type: array
        items:
          type: string
      additional_methods:
        description: Additional repository methods to generate
        type: array
        items:
          type: object
          properties:
            name:
              description: Method name
              type: string
            params:
              description: Method parameters
              type: array
              items:
                type: string
            returns:
              description: Return type (single or multiple)
              type: string
              enum: [single, multiple]
          required: [name, returns]
          additionalProperties: false
      table_name:
        description: Override default table name
        type: string
    additionalProperties: false

  commands:
    description: Command handler generation configuration
    type: object
    properties:
      operations:
        description: Standard command operations to generate
        type: array
        items:
          type: string
          enum: [create, update, delete]
      additional_methods:
        description: Additional command handlers to generate
        type: array
        items:
          type: object
          properties:
            operationId:
              description: OpenAPI operation ID to map to this command
              type: string
            handler:
              description: Optional custom handler name
              type: string
          required: [operationId]
          additionalProperties: false
    additionalProperties: false

  queries:
    description: Query handler generation configuration
    type: object
    properties:
      operations:
        description: Standard query operations to generate
        type: array
        items:
          type: string
          enum: [get, list]
      additional_methods:
        description: Additional query handlers to generate
        type: array
        items:
          type: object
          properties:
            operationId:
              description: OpenAPI operation ID to map to this query
              type: string
            handler:
              description: Optional custom handler name
              type: string
          required: [operationId]
          additionalProperties: false
    additionalProperties: false

  controller:
    description: HTTP controller generation configuration
    type: object
    properties:
      operations:
        description: Standard CRUD operations to include in controller
        type: array
        items:
          type: string
          enum: [create, read, update, delete, list]
        default: [create, read, update, delete, list]
      middleware:
        description: Middleware to apply to this controller
        type: array
        items:
          type: string
    additionalProperties: false
# This schema defines the x-codegen extension structure
# It should NOT have its own x-codegen extension
x-codegen:
  schemaType: valueobject
