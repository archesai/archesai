import { Card } from "@archesai/ui";
import { createFileRoute } from "@tanstack/react-router";
import type { JSX } from "react";
import { Suspense } from "react";
import { useGet[[ .Entity.EntityName ]]Suspense } from "#lib/index";
import { getRouteMeta } from "#lib/site-utils";

export const metadata = getRouteMeta("/[[ .Entity.EntityNameKebab ]]s/$[[ .Entity.EntityNameLower ]]ID");

export const Route = createFileRoute("/_app/[[ .Entity.EntityNameKebab ]]s/$[[ .Entity.EntityNameLower ]]ID/")({
  component: [[ .Entity.EntityName ]]DetailsPage,
});

function [[ .Entity.EntityName ]]DetailsPage(): JSX.Element {
  const params = Route.useParams();
  const [[ .Entity.EntityNameLower ]]ID = params.[[ .Entity.EntityNameLower ]]ID;

  return (
    <div className="flex h-full w-full gap-4">
      <Card className="flex-1">
        <Suspense fallback={<div>Loading...</div>}>
          <[[ .Entity.EntityName ]]Details [[ .Entity.EntityNameLower ]]ID={[[ .Entity.EntityNameLower ]]ID} />
        </Suspense>
      </Card>
    </div>
  );
}

function [[ .Entity.EntityName ]]Details({
  [[ .Entity.EntityNameLower ]]ID,
}: {
  [[ .Entity.EntityNameLower ]]ID: string;
}): JSX.Element {
  const {
    data: { data: [[ .Entity.EntityNameLower ]] },
  } = useGet[[ .Entity.EntityName ]]Suspense([[ .Entity.EntityNameLower ]]ID);

  return (
    <div className="space-y-4 p-4">
      <h1 className="text-2xl font-bold">[[ .Entity.EntityName ]] Details</h1>
      <dl className="grid grid-cols-2 gap-4">
[[- range .Entity.Columns ]]
        <div>
          <dt className="text-sm font-medium text-muted-foreground">[[ .Label ]]</dt>
          <dd className="mt-1 text-sm">{String([[ $.Entity.EntityNameLower ]].[[ .AccessorKey ]])}</dd>
        </div>
[[- end ]]
      </dl>
    </div>
  );
}
