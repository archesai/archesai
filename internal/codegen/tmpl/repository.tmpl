{{- /*
Template: repository.tmpl
Expects: codegen.RepositoryTemplateInput
Generates: Repository interfaces

Expected structure:
- Package: string (package name)
- Domain: string (domain name)
- Entities: []EntityData
  - Name: string (entity name)
  - Type: string (entity type)
  - EntityPackage: string (entities, aggregates, or valueobjects)
  - AdditionalMethods: []MethodData
    - Name: string (method name)
    - Parameters: []ParamData
      - Name: string
      - Type: string
    - Returns: []string (return types)
*/ -}}
// Code generated by codegen repository. DO NOT EDIT.
package {{.Package}}

import (
	"context"

	"github.com/archesai/archesai/internal/application/dto"
{{- range .Entities }}
{{- if eq .EntityPackage "aggregates" }}
	"github.com/archesai/archesai/internal/core/aggregates"
{{- else if eq .EntityPackage "valueobjects" }}
	"github.com/archesai/archesai/internal/core/valueobjects"
{{- else }}
	"github.com/archesai/archesai/internal/core/entities"
{{- end }}
{{- end }}
	"github.com/google/uuid"
)

{{range .Entities}}{{$entity := .}}{{$pkg := .EntityPackage}}
// {{.Name}}Repository handles {{lower .Name}} persistence
type {{.Name}}Repository interface {
	// Basic CRUD operations (always included)
	Create(ctx context.Context, entity *{{$pkg}}.{{.Type}}) (*{{$pkg}}.{{.Type}}, error)
	Get(ctx context.Context, id uuid.UUID) (*{{$pkg}}.{{.Type}}, error)
	Update(ctx context.Context, id uuid.UUID, entity *{{$pkg}}.{{.Type}}) (*{{$pkg}}.{{.Type}}, error)
	Delete(ctx context.Context, id uuid.UUID) error
	List(ctx context.Context, params dto.List{{.Name}}sParams) ([]*{{$pkg}}.{{.Type}}, int64, error)
{{if .AdditionalMethods}}
	// Additional operations
{{range .AdditionalMethods}}	// {{.Name}} retrieves {{if hasPrefix .Name "List"}}multiple {{$entity.Type | singularize | lower}}s{{else}}a single {{$entity.Type | singularize | lower}}{{end}}{{if .Parameters}} by {{range $i, $p := .Parameters}}{{if $i}} and {{end}}{{$p.Name}}{{end}}{{end}}
	{{.Name}}(ctx context.Context{{range $i, $param := .Parameters}}, {{$param.Name}} {{$param.Type}}{{end}}) ({{range $i, $ret := .Returns}}{{if $i}}, {{end}}{{if eq $ret (print "*" $entity.Type)}}*{{$pkg}}.{{$entity.Type}}{{else if eq $ret (print "[]*" $entity.Type)}}[]*{{$pkg}}.{{$entity.Type}}{{else}}{{$ret}}{{end}}{{end}})
{{end}}{{end}}
}
{{end}}

