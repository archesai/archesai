// Code generated by archesai/codegen. DO NOT EDIT.

package entities

import (
	"fmt"
	"time"

	"github.com/archesai/archesai/internal/core/events"
	"github.com/google/uuid"
)

// User represents Schema for User entity
type User struct {
	CreatedAt     time.Time            `json:"createdAt" yaml:"createdAt"`             // The date and time when the resource was created
	Email         string               `json:"email" yaml:"email"`                     // The user's email address
	EmailVerified bool                 `json:"emailVerified" yaml:"emailVerified"`     // Whether the user's email has been verified
	ID            uuid.UUID            `json:"id" yaml:"id"`                           // Unique identifier for the resource
	Image         *string              `json:"image,omitempty" yaml:"image,omitempty"` // The user's avatar image URL
	Name          string               `json:"name" yaml:"name"`                       // The user's display name
	UpdatedAt     time.Time            `json:"updatedAt" yaml:"updatedAt"`             // The date and time when the resource was last updated
	events        []events.DomainEvent `json:"-" yaml:"-"`
}

// NewUser creates a new User entity
func NewUser(
	email string,
	emailVerified bool,
	name string,
) (*User, error) {
	if email == "" {
		return nil, fmt.Errorf("Email cannot be empty")
	}
	if name == "" {
		return nil, fmt.Errorf("Name cannot be empty")
	}

	user := &User{
		CreatedAt:     time.Now().UTC(),
		Email:         email,
		EmailVerified: emailVerified,
		ID:            uuid.New(),
		Name:          name,
		UpdatedAt:     time.Now().UTC(),
		events:        []events.DomainEvent{},
	}
	user.addEvent(events.NewUserCreatedEvent(user.ID))

	return user, nil
}

// GetCreatedAt returns the CreatedAt
func (e *User) GetCreatedAt() time.Time {
	return e.CreatedAt
}

// GetEmail returns the Email
func (e *User) GetEmail() string {
	return e.Email
}

// GetEmailVerified returns the EmailVerified
func (e *User) GetEmailVerified() bool {
	return e.EmailVerified
}

// GetID returns the ID
func (e *User) GetID() uuid.UUID {
	return e.ID
}

// GetImage returns the Image
func (e *User) GetImage() *string {
	return e.Image
}

// GetName returns the Name
func (e *User) GetName() string {
	return e.Name
}

// GetUpdatedAt returns the UpdatedAt
func (e *User) GetUpdatedAt() time.Time {
	return e.UpdatedAt
}

// Events returns the domain events
func (e *User) Events() []events.DomainEvent {
	return e.events
}

// ClearEvents clears the domain events
func (e *User) ClearEvents() {
	e.events = []events.DomainEvent{}
}

// addEvent adds a domain event
func (e *User) addEvent(event events.DomainEvent) {
	e.events = append(e.events, event)
}

// ReconstructUser reconstructs a User from persistence
func ReconstructUser(
	createdAt time.Time,
	email string,
	emailVerified bool,
	id uuid.UUID,
	image *string,
	name string,
	updatedAt time.Time,
) *User {
	return &User{
		CreatedAt:     createdAt,
		Email:         email,
		EmailVerified: emailVerified,
		ID:            id,
		Image:         image,
		Name:          name,
		UpdatedAt:     updatedAt,
		events:        []events.DomainEvent{},
	}
}
