// Code generated by archesai/codegen. DO NOT EDIT.

package entities

import (
	"fmt"
	"time"

	"github.com/archesai/archesai/internal/core/events"
	"github.com/google/uuid"
)

// OrganizationPlan represents the enumeration of valid values for Plan
type OrganizationPlan string

// Valid Plan values
const (
	OrganizationPlanFREE      OrganizationPlan = "FREE"
	OrganizationPlanBASIC     OrganizationPlan = "BASIC"
	OrganizationPlanSTANDARD  OrganizationPlan = "STANDARD"
	OrganizationPlanPREMIUM   OrganizationPlan = "PREMIUM"
	OrganizationPlanUNLIMITED OrganizationPlan = "UNLIMITED"
)

// String returns the string representation
func (e OrganizationPlan) String() string {
	return string(e)
}

// IsValid checks if the value is valid
func (e OrganizationPlan) IsValid() bool {
	switch e {
	case OrganizationPlanFREE:
		return true
	case OrganizationPlanBASIC:
		return true
	case OrganizationPlanSTANDARD:
		return true
	case OrganizationPlanPREMIUM:
		return true
	case OrganizationPlanUNLIMITED:
		return true
	default:
		return false
	}
}

// ParseOrganizationPlan parses a string into the enum type
func ParseOrganizationPlan(s string) (OrganizationPlan, error) {
	v := OrganizationPlan(s)
	if !v.IsValid() {
		return "", fmt.Errorf("invalid Plan: %s", s)
	}
	return v, nil
}

// Organization represents Schema for Organization entity
type Organization struct {
	BillingEmail             *string              `json:"billingEmail,omitempty" yaml:"billingEmail,omitempty"`     // Email address for billing communications
	CreatedAt                time.Time            `json:"createdAt" yaml:"createdAt"`                               // The date and time when the resource was created
	Credits                  int32                `json:"credits" yaml:"credits"`                                   // Available credits for this organization
	ID                       uuid.UUID            `json:"id" yaml:"id"`                                             // Unique identifier for the resource
	Logo                     *string              `json:"logo,omitempty" yaml:"logo,omitempty"`                     // The organization's logo URL
	Name                     string               `json:"name" yaml:"name"`                                         // The organization's display name
	Plan                     OrganizationPlan     `json:"plan" yaml:"plan"`                                         // The current subscription plan
	Slug                     string               `json:"slug" yaml:"slug"`                                         // URL-friendly unique identifier for the organization
	StripeCustomerIdentifier string               `json:"stripeCustomerIdentifier" yaml:"stripeCustomerIdentifier"` // Stripe customer identifier
	UpdatedAt                time.Time            `json:"updatedAt" yaml:"updatedAt"`                               // The date and time when the resource was last updated
	events                   []events.DomainEvent `json:"-" yaml:"-"`
}

// NewOrganization creates a new Organization entity with validation.
// All required fields must be provided and valid.
func NewOrganization(
	credits int32,
	name string,
	plan OrganizationPlan,
	slug string,
	stripeCustomerIdentifier string,
) (*Organization, error) {
	// Validate required fields
	if name == "" {
		return nil, fmt.Errorf("Name cannot be empty")
	}
	if !plan.IsValid() {
		return nil, fmt.Errorf("invalid Plan: %s", plan)
	}
	if slug == "" {
		return nil, fmt.Errorf("Slug cannot be empty")
	}
	if stripeCustomerIdentifier == "" {
		return nil, fmt.Errorf("StripeCustomerIdentifier cannot be empty")
	}

	now := time.Now().UTC()
	organization := &Organization{
		CreatedAt:                now,
		Credits:                  credits,
		ID:                       uuid.New(),
		Name:                     name,
		Plan:                     plan,
		Slug:                     slug,
		StripeCustomerIdentifier: stripeCustomerIdentifier,
		UpdatedAt:                now,
		events:                   []events.DomainEvent{},
	}
	organization.addEvent(events.NewOrganizationCreatedEvent(organization.ID))

	return organization, nil
}

// GetBillingEmail returns the BillingEmail
func (e *Organization) GetBillingEmail() *string {
	return e.BillingEmail
}

// GetCreatedAt returns the CreatedAt
func (e *Organization) GetCreatedAt() time.Time {
	return e.CreatedAt
}

// GetCredits returns the Credits
func (e *Organization) GetCredits() int32 {
	return e.Credits
}

// GetID returns the ID
func (e *Organization) GetID() uuid.UUID {
	return e.ID
}

// GetLogo returns the Logo
func (e *Organization) GetLogo() *string {
	return e.Logo
}

// GetName returns the Name
func (e *Organization) GetName() string {
	return e.Name
}

// GetPlan returns the Plan
func (e *Organization) GetPlan() string {
	return string(e.Plan)
}

// GetSlug returns the Slug
func (e *Organization) GetSlug() string {
	return e.Slug
}

// GetStripeCustomerIdentifier returns the StripeCustomerIdentifier
func (e *Organization) GetStripeCustomerIdentifier() string {
	return e.StripeCustomerIdentifier
}

// GetUpdatedAt returns the UpdatedAt
func (e *Organization) GetUpdatedAt() time.Time {
	return e.UpdatedAt
}

// Events returns the domain events
func (e *Organization) Events() []events.DomainEvent {
	return e.events
}

// ClearEvents clears the domain events
func (e *Organization) ClearEvents() {
	e.events = []events.DomainEvent{}
}

// addEvent adds a domain event
func (e *Organization) addEvent(event events.DomainEvent) {
	e.events = append(e.events, event)
}

// ReconstructOrganization reconstructs a Organization from persistence
func ReconstructOrganization(
	billingEmail *string,
	createdAt time.Time,
	credits int32,
	id uuid.UUID,
	logo *string,
	name string,
	plan string,
	slug string,
	stripeCustomerIdentifier string,
	updatedAt time.Time,
) *Organization {
	return &Organization{
		BillingEmail:             billingEmail,
		CreatedAt:                createdAt,
		Credits:                  credits,
		ID:                       id,
		Logo:                     logo,
		Name:                     name,
		Plan:                     OrganizationPlan(plan),
		Slug:                     slug,
		StripeCustomerIdentifier: stripeCustomerIdentifier,
		UpdatedAt:                updatedAt,
		events:                   []events.DomainEvent{},
	}
}
