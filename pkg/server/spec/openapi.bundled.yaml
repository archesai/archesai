openapi: 3.1.0
x-project-name: github.com/archesai/archesai/pkg/server
info:
  title: Arches Server API
  description: Server schemas for Arches platform
  version: v0.0.0
tags:
  - name: Health
    description: Health check operations
paths:
  /health:
    $ref: '#/components/pathItems/health'
components:
  headers:
    RateLimitLimit:
      description: The maximum number of requests allowed per time window
      schema:
        type: integer
        example: 1000
        format: int32
        minimum: 1
        maximum: 1000000
      example: 1000
    RateLimitRemaining:
      description: The number of requests remaining in the current time window
      schema:
        type: integer
        example: 999
        format: int32
        minimum: 0
        maximum: 1000000
      example: 999
    RateLimitReset:
      description: The time at which the current rate limit window resets (Unix timestamp)
      schema:
        type: integer
        example: 1640995200
        format: int64
        minimum: 0
        maximum: 9223372036854776000
      example: 1640995200
    RetryAfter:
      description: Number of seconds to wait before making a new request
      schema:
        type: integer
        example: 60
        format: int32
        minimum: 1
        maximum: 3600
      example: 60
  parameters:
    PageQuery:
      in: query
      name: page
      required: false
      style: form
      explode: true
      schema:
        $ref: '#/components/schemas/Page'
      description: The page parameter
      example:
        limit: 10
        offset: 0
    ResourceID:
      schema:
        $ref: '#/components/schemas/UUID'
      in: path
      name: id
      required: true
      description: The unique identifier of the resource.
  responses:
    BadRequest:
      description: 400 Bad Request
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/Problem'
      headers:
        X-RateLimit-Limit:
          $ref: '#/components/headers/RateLimitLimit'
        X-RateLimit-Remaining:
          $ref: '#/components/headers/RateLimitRemaining'
        X-RateLimit-Reset:
          $ref: '#/components/headers/RateLimitReset'
    Conflict:
      description: 409 Conflict
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/Problem'
      headers:
        X-RateLimit-Limit:
          $ref: '#/components/headers/RateLimitLimit'
        X-RateLimit-Remaining:
          $ref: '#/components/headers/RateLimitRemaining'
        X-RateLimit-Reset:
          $ref: '#/components/headers/RateLimitReset'
    HealthResponse:
      description: Health status retrieved successfully
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Health'
      headers:
        X-RateLimit-Limit:
          $ref: '#/components/headers/RateLimitLimit'
        X-RateLimit-Remaining:
          $ref: '#/components/headers/RateLimitRemaining'
        X-RateLimit-Reset:
          $ref: '#/components/headers/RateLimitReset'
    InternalServerError:
      description: Internal server error
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/Problem'
      headers:
        X-RateLimit-Limit:
          $ref: '#/components/headers/RateLimitLimit'
        X-RateLimit-Remaining:
          $ref: '#/components/headers/RateLimitRemaining'
        X-RateLimit-Reset:
          $ref: '#/components/headers/RateLimitReset'
    NoContent:
      description: 204 No Content
      headers:
        X-RateLimit-Limit:
          $ref: '#/components/headers/RateLimitLimit'
        X-RateLimit-Remaining:
          $ref: '#/components/headers/RateLimitRemaining'
        X-RateLimit-Reset:
          $ref: '#/components/headers/RateLimitReset'
    NotFound:
      description: 404 Not Found
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/Problem'
      headers:
        X-RateLimit-Limit:
          $ref: '#/components/headers/RateLimitLimit'
        X-RateLimit-Remaining:
          $ref: '#/components/headers/RateLimitRemaining'
        X-RateLimit-Reset:
          $ref: '#/components/headers/RateLimitReset'
    TooManyRequests:
      description: Too many requests - rate limit exceeded
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/Problem'
      headers:
        X-RateLimit-Limit:
          $ref: '#/components/headers/RateLimitLimit'
        X-RateLimit-Remaining:
          $ref: '#/components/headers/RateLimitRemaining'
        X-RateLimit-Reset:
          $ref: '#/components/headers/RateLimitReset'
        Retry-After:
          $ref: '#/components/headers/RetryAfter'
    Unauthorized:
      description: 401 Unauthorized
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/Problem'
      headers:
        X-RateLimit-Limit:
          $ref: '#/components/headers/RateLimitLimit'
        X-RateLimit-Remaining:
          $ref: '#/components/headers/RateLimitRemaining'
        X-RateLimit-Reset:
          $ref: '#/components/headers/RateLimitReset'
    UnprocessableEntity:
      description: 422 Unprocessable Entity
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/Problem'
      headers:
        X-RateLimit-Limit:
          $ref: '#/components/headers/RateLimitLimit'
        X-RateLimit-Remaining:
          $ref: '#/components/headers/RateLimitRemaining'
        X-RateLimit-Reset:
          $ref: '#/components/headers/RateLimitReset'
  schemas:
    Page:
      description: Pagination parameters (limit & offset)
      x-internal: server
      type: object
      title: Page
      additionalProperties: false
      properties:
        limit:
          description: Maximum number of items to return
          type: integer
          format: int32
          minimum: 1
          default: 10
          maximum: 100
          example: 10
        offset:
          description: Number of items to skip before starting to collect the result set
          type: integer
          format: int32
          minimum: 0
          default: 0
          maximum: 9007199254740991
          example: 0
    UUID:
      description: UUID identifier
      x-internal: server
      type: string
      format: uuid
      example: 550e8400-e29b-41d4-a716-446655440000
      minLength: 36
      maxLength: 36
    Problem:
      title: Problem
      description: RFC 7807 (Problem Details) compliant error response
      x-internal: server
      type: object
      additionalProperties: false
      required:
        - status
        - title
      properties:
        status:
          type: integer
          format: int32
          description: HTTP status code
          minimum: 100
          maximum: 599
          example: 400
        type:
          type: string
          format: uri
          description: URI identifying the problem type
          default: about:blank
          example: https://api.example.com/errors/validation-failed
          minLength: 1
          maxLength: 2048
        title:
          type: string
          description: Short, human-readable summary
          example: Validation Failed
          minLength: 1
          maxLength: 255
          pattern: ^[\w\s\-.,!?()]+$
        detail:
          type: string
          description: Human-readable explanation specific to this occurrence
          example: The request body contains invalid fields
          minLength: 1
          maxLength: 255
          pattern: ^[\w\s\-.,!?()]+$
        instance:
          type: string
          format: uri
          description: URI identifying the specific occurrence
          example: https://api.example.com/auth/users/123
          maxLength: 2048
    Health:
      title: Health
      description: Health check response
      x-internal: server
      x-codegen-schema-type: valueobject
      type: object
      properties:
        services:
          type: object
          properties:
            database:
              type: string
              example: healthy
              enum:
                - healthy
                - unhealthy
                - degraded
            email:
              type: string
              example: healthy
              enum:
                - healthy
                - unhealthy
                - degraded
            redis:
              type: string
              example: healthy
              enum:
                - healthy
                - unhealthy
                - degraded
          required:
            - database
            - email
            - redis
          additionalProperties: false
        timestamp:
          type: string
          format: date-time
          maxLength: 64
          example: '2024-01-15T09:30:00Z'
        uptime:
          description: System uptime in seconds
          type: integer
          format: int64
          minimum: 0
          maximum: 9223372036854776000
          example: 86400
      required:
        - services
        - timestamp
        - uptime
      additionalProperties: false
  pathItems:
    health:
      get:
        x-internal: server
        x-codegen-custom-handler: true
        operationId: GetHealth
        summary: Get health status
        tags:
          - Health
        description: Check the health status of the application
        responses:
          '200':
            $ref: '#/components/responses/HealthResponse'
          '400':
            $ref: '#/components/responses/BadRequest'
          '401':
            $ref: '#/components/responses/Unauthorized'
          '429':
            $ref: '#/components/responses/TooManyRequests'
          '500':
            $ref: '#/components/responses/InternalServerError'
        security:
          - {}
