# yaml-language-server: $schema=https://raw.githubusercontent.com/evilmartians/lefthook/refs/heads/master/schema.json
pre-commit:
  parallel: true
  commands:
    lint:
      run: make lint

    go-mod-tidy:
      glob: 'go.{mod,sum}'
      run: go mod tidy

    format:
      run: make format
      stage_fixed: true

commit-msg:
  commands:
    commitizen:
      run: |
        commit_regex='^(feat|fix|docs|style|refactor|perf|test|chore|build|ci|revert)(\(.+\))?: .{1,50}'
        commit_message=$(cat "{1}")
        if ! echo "$commit_message" | grep -qE "$commit_regex"; then
          echo "‚ùå Invalid commit message format!"
          echo "Your message: '$commit_message'"
          echo ""
          echo "Format: type(scope): description"
          echo "Types: feat, fix, docs, style, refactor, perf, test, chore, build, ci, revert"
          echo "Example: feat(auth): add user login endpoint"
          exit 1
        fi

pre-push:
  commands:
    # go-test:
    #   run: go test -race -coverprofile=coverage.out ./...

    go-build:
      run: go build ./...
